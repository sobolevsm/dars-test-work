# Приложение для работы с книгами

## Установка
Необходимо запустить команду ````make init```` для развертывания проекта. <br>В случае если make не установлен на запускающей машине,
можно воспользоваться след.последовательностью команд:
1. cp -n .env-sample .env
2. docker-compose build
3. docker-compose run --rm php composer install
4. docker-compose up --detach
5. docker-compose run --rm php php yii migrate --interactive=0

После чего приложение будет доступно на localhost и порту, указанном в переменной ````DOCKER_NGINX_API_PORT````
<br>По умолчанию порт 8884

## Описание api

Все параметры, которые передаются в запросах, должны быть в формате json.

## Админ

Все методы предназначенные для админа ожидают ````X-Access-Token```` в заголовке метода, иначе не будет получен доступ.<br>
Значение токена можно взять в таблице ````access_token````

### Автор

1. ````POST /admin/author```` - Запрос на создание автора книги. Обязательные параметры:
    - name
    - country 


2. ````GET /admin/author```` - Запрос на получение списка всех авторов.


3. ````GET /admin/author/id```` - Запрос на получение автора по id.


5. ````PUT /admin/author/id```` - Запрос на обновление автора по id. Принимает опциональные параметры(хотя бы один из аргументов должен быть передан):
    - name
    - country


6. ````DELETE /admin/author/id```` - Запрос на удаление автора по id.


### Жанр

1. ````POST /admin/genre```` - Запрос на создание жанра. Обязательные параметры:
    - title


2. ````GET /admin/genre```` - Запрос на получение списка всех жанров.


3. ````GET /admin/genre/id```` - Запрос на получение жанра по id.


5. ````PUT /admin/genre/id```` - Запрос на обновление жанра по id. Обязательные параметры:
    - title


6. ````DELETE /admin/genre/id```` - Запрос на удаление жанра по id.


### Книга

1. ````POST /admin/book```` - Запрос на создание книги. Обязательные параметры:
    - title - Название
    - genresId - массив со списком id жанров
    - authorId - id автора
    - publishedDate - Дата публикации в формате Y-m-d


2. ````GET /admin/book```` - Запрос на получение списка всех книг.


3. ````GET /admin/book/id```` - Запрос на получение книги по id.


5. ````PUT /admin/book/id```` - Запрос на обновление книги по id. Принимает опциональные параметры(хотя бы один из аргументов должен быть передан):
   - title - Название
   - genresId - массив со списком id жанров
   - authorId - id автора
   - publishedDate - Дата публикации в формате Y-m-d


6. ````DELETE /admin/book/id```` - Запрос на удаление книги по id.

## Клиент
### Книга

1. ````POST /book```` - Запрос для получения списка всех книг с учетом фильтров и пагинации. Параметры:
    - filters:
        - genresId - массив со списком id жанров
        - authorName - Имя автора
        - authorCountry - Страна автора
        - publicationDate - дата публикации книги
    - pager:
        - page - страница выдачи
        - limit - максимальное кол-во книг в выдаче

Пример запроса:
{
"filters": {
"genresId": [1],
"authorName": "Чехов",
"authorCountry": "Россия",
"publicationDate": "2023-03-08"
},
"pager": {
"page": 1,
"limit": 10
}
}


Параметр pager является обязательным. Все фильтры опциональны.


## Список возможных доработок и улучшений
1. Для всех методов работающих на получение списков из базы добавить пагинацию.


2. Клиентский роут для получения книг работает на Limit/offset пагинации, в случае работы с большим объемом данных, 
<br>лучше перейти на использование пагинации по ключам в целях оптимизации времени запросов.


3. Добавить обработку случая создания дублей всех сущностей приложения в базе.


4. Написание тестов

